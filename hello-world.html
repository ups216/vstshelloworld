<!DOCTYPE html>
<html xmlns="httpï¼š//www.w3.org/1999/xhtml">
<head>
	<title>Hello World</title>
	<script src="sdk/scripts/VSS.SDK.js"></script>
	<script src="sdk/scripts/jquery-1.11.3.min.js"></script>	
</head>
<body>
	<script type="text/javascript">
		// Sets up the inital handshake with the host frame
		VSS.init({
			// Our extension will explicityly notify the host when we're done loading
			explicitNotifyLoaded:true,
			
			// We are using some VSTS APIs, so we will need the module loader to load them in
			usePlatformScripts:true,
			usePlatformStyles:true
		});
		VSS.require(
			["VSS/Controls", "VSS/Controls/Grids", "VSS/Service", "TFS/WorkItemTracking/RestClient"],
			function (Controls, Grids, VSS_Service, TFS_Wit_WebApi){
				// Get a WIT client tomake REST calls to VSTS
				var witClient = VSS_Service.getCollectionClient(TFS_Wit_WebApi.WorkItemTrackingHttpClient);
				
				witClient.queryById(location.search.substr("?queryId=".length)).then(function(queryResult){
					var workItemIds = queryResult.workItems.map(function(reference){return reference.id;});
					
					// Call the "queryById" REST endpoint, giving a query ID
					witClient.getWorkItems(
						// work item ids
						workItemIds,
						["System.Title"]	
					).then(function(workitems){
						Controls.create(Grids.Grid, $("#grid-container"), {
							height: "1000px", // Explicit height is required for a Grid control
							columns: [
								// text is the column header text. 
								// index is the key into the source object to find the data for this column
								// width is the width of the column, in pixels
								{ text: "Work Item ID", index: "id", width: 150 },
					
								// getColumnValue provides a mechanism for the grid to get the data for a cell
								// (at the given row number) if it is not directly keyed off the source object.
								{ text: "Title", width: 150, getColumnValue: function(dataIndex) { 
									// The Work Item's Title is at source[row].fields["System.Title"].
									// this.getRowData(n) returns the nth item from the source object, so we 
									// can return the "System.Title" property under fields.
									return this.getRowData(dataIndex).fields["System.Title"]; 
								} },
								{ text: "URL", index: "url", width: 600 }
							],
							// This data source is rendered into the Grid columns defined above
							source: workitems
						});
					});
				});			
				
				
				VSS.notifyLoadSucceeded();	
			}
		);
	</script>
	<h1>Hello World 2</h1>
	<div id="grid-container">
		
	</div>
	<button id="show" title="show dialog" onclick="showdiag();">Show Dialog</button>
	<script type="text/javascript">
	
	function showdiag(){
		VSS.getService(VSS.ServiceIds.Dialog).then(function(dialogService) {
        var extensionCtx = VSS.getExtensionContext();
        // Build absolute contribution id for dialogContent
        var contributionId = extensionCtx.publisherId + "." + extensionCtx.extensionId + ".LeanSoft.context";
		alert(contributionId);

        // Show dialog
        var dialogOptions = {
            title: "My Dialog",
            width: 800,
            height: 600
        };

        dialogService.openDialog(contributionId, dialogOptions);
    	});
	}
		
	</script>
</body>
</html>